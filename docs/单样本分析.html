<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>ç¬¬ 7 ç«  å•æ ·æœ¬åˆ†æ | scRNA-Seq åˆ†æç¬”è®°</title>
  <meta name="description" content="This is an online note of the scRNA-Seq analysis." />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="ç¬¬ 7 ç«  å•æ ·æœ¬åˆ†æ | scRNA-Seq åˆ†æç¬”è®°" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is an online note of the scRNA-Seq analysis." />
  <meta name="github-repo" content="smileszh/scRNA-Seq" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="ç¬¬ 7 ç«  å•æ ·æœ¬åˆ†æ | scRNA-Seq åˆ†æç¬”è®°" />
  
  <meta name="twitter:description" content="This is an online note of the scRNA-Seq analysis." />
  

<meta name="author" content="è‹æ€»å" />


<meta name="date" content="2024-11-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="part-scrna-seq-å…¥é—¨.html"/>
<link rel="next" href="å¤šæ ·æœ¬åˆ†æ.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">scRNA-Seq ç¬”è®°</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>å‰è¨€</a></li>
<li class="chapter" data-level="1" data-path="part-åˆè¯†-scrna-seq.html"><a href="part-åˆè¯†-scrna-seq.html"><i class="fa fa-check"></i><b>1</b> (PART) åˆè¯† scRNA-Seq</a></li>
<li class="chapter" data-level="2" data-path="scrna-seq-ç®€ä»‹.html"><a href="scrna-seq-ç®€ä»‹.html"><i class="fa fa-check"></i><b>2</b> scRNA-Seq ç®€ä»‹</a></li>
<li class="chapter" data-level="3" data-path="part-scrna-seq-åŸºç¡€çŸ¥è¯†.html"><a href="part-scrna-seq-åŸºç¡€çŸ¥è¯†.html"><i class="fa fa-check"></i><b>3</b> (PART) scRNA-Seq åŸºç¡€çŸ¥è¯†</a></li>
<li class="chapter" data-level="4" data-path="scrna-seq-åŸºæœ¬æ¦‚å¿µ.html"><a href="scrna-seq-åŸºæœ¬æ¦‚å¿µ.html"><i class="fa fa-check"></i><b>4</b> scRNA-Seq åŸºæœ¬æ¦‚å¿µ</a>
<ul>
<li class="chapter" data-level="4.1" data-path="scrna-seq-åŸºæœ¬æ¦‚å¿µ.html"><a href="scrna-seq-åŸºæœ¬æ¦‚å¿µ.html#å•ç»†èƒ-rna-æµ‹åº"><i class="fa fa-check"></i><b>4.1</b> å•ç»†èƒ RNA æµ‹åº</a></li>
<li class="chapter" data-level="4.2" data-path="scrna-seq-åŸºæœ¬æ¦‚å¿µ.html"><a href="scrna-seq-åŸºæœ¬æ¦‚å¿µ.html#é«˜å˜åŸºå› highly-variable-genes-hvgs"><i class="fa fa-check"></i><b>4.2</b> é«˜å˜åŸºå› ï¼ˆHighly Variable Genes, HVGsï¼‰</a></li>
<li class="chapter" data-level="4.3" data-path="scrna-seq-åŸºæœ¬æ¦‚å¿µ.html"><a href="scrna-seq-åŸºæœ¬æ¦‚å¿µ.html#marker-åŸºå› "><i class="fa fa-check"></i><b>4.3</b> Marker åŸºå› </a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="å•ç»†èƒåŸºæœ¬åˆ†ææµç¨‹.html"><a href="å•ç»†èƒåŸºæœ¬åˆ†ææµç¨‹.html"><i class="fa fa-check"></i><b>5</b> å•ç»†èƒåŸºæœ¬åˆ†ææµç¨‹</a>
<ul>
<li class="chapter" data-level="5.1" data-path="å•ç»†èƒåŸºæœ¬åˆ†ææµç¨‹.html"><a href="å•ç»†èƒåŸºæœ¬åˆ†ææµç¨‹.html#æ•°æ®è¯»å–"><i class="fa fa-check"></i><b>5.1</b> æ•°æ®è¯»å–</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="å•ç»†èƒåŸºæœ¬åˆ†ææµç¨‹.html"><a href="å•ç»†èƒåŸºæœ¬åˆ†ææµç¨‹.html#x-genomics-ä¸‰æ–‡ä»¶"><i class="fa fa-check"></i><b>5.1.1</b> 10X Genomics ä¸‰æ–‡ä»¶</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="å•ç»†èƒåŸºæœ¬åˆ†ææµç¨‹.html"><a href="å•ç»†èƒåŸºæœ¬åˆ†ææµç¨‹.html#è´¨é‡æ§åˆ¶æŒ‡æ ‡"><i class="fa fa-check"></i><b>5.2</b> è´¨é‡æ§åˆ¶æŒ‡æ ‡</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="å•ç»†èƒåŸºæœ¬åˆ†ææµç¨‹.html"><a href="å•ç»†èƒåŸºæœ¬åˆ†ææµç¨‹.html#ncount_rna-ä¸-percent.mt-ç›¸å…³å…³ç³»"><i class="fa fa-check"></i><b>5.2.1</b> nCount_RNA ä¸ percent.mt ç›¸å…³å…³ç³»</a></li>
<li class="chapter" data-level="5.2.2" data-path="å•ç»†èƒåŸºæœ¬åˆ†ææµç¨‹.html"><a href="å•ç»†èƒåŸºæœ¬åˆ†ææµç¨‹.html#ncount_rna-ä¸-nfeature_rna-çš„å…³ç³»"><i class="fa fa-check"></i><b>5.2.2</b> nCount_RNA ä¸ nFeature_RNA çš„å…³ç³»</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="å•ç»†èƒåŸºæœ¬åˆ†ææµç¨‹.html"><a href="å•ç»†èƒåŸºæœ¬åˆ†ææµç¨‹.html#æ•°æ®æ ‡å‡†åŒ–"><i class="fa fa-check"></i><b>5.3</b> æ•°æ®æ ‡å‡†åŒ–</a></li>
<li class="chapter" data-level="5.4" data-path="å•ç»†èƒåŸºæœ¬åˆ†ææµç¨‹.html"><a href="å•ç»†èƒåŸºæœ¬åˆ†ææµç¨‹.html#è¯†åˆ«é«˜å˜åŸºå› "><i class="fa fa-check"></i><b>5.4</b> è¯†åˆ«é«˜å˜åŸºå› </a></li>
<li class="chapter" data-level="5.5" data-path="å•ç»†èƒåŸºæœ¬åˆ†ææµç¨‹.html"><a href="å•ç»†èƒåŸºæœ¬åˆ†ææµç¨‹.html#ç¼©æ”¾æ•°æ®"><i class="fa fa-check"></i><b>5.5</b> ç¼©æ”¾æ•°æ®</a></li>
<li class="chapter" data-level="5.6" data-path="å•ç»†èƒåŸºæœ¬åˆ†ææµç¨‹.html"><a href="å•ç»†èƒåŸºæœ¬åˆ†ææµç¨‹.html#pcaçº¿æ€§é™ç»´"><i class="fa fa-check"></i><b>5.6</b> PCAçº¿æ€§é™ç»´</a></li>
<li class="chapter" data-level="5.7" data-path="å•ç»†èƒåŸºæœ¬åˆ†ææµç¨‹.html"><a href="å•ç»†èƒåŸºæœ¬åˆ†ææµç¨‹.html#ç»†èƒèšç±»"><i class="fa fa-check"></i><b>5.7</b> ç»†èƒèšç±»</a></li>
<li class="chapter" data-level="5.8" data-path="å•ç»†èƒåŸºæœ¬åˆ†ææµç¨‹.html"><a href="å•ç»†èƒåŸºæœ¬åˆ†ææµç¨‹.html#éçº¿æ€§é™ç»´umaptsne"><i class="fa fa-check"></i><b>5.8</b> éçº¿æ€§é™ç»´UMAP/tSNE</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="part-scrna-seq-å…¥é—¨.html"><a href="part-scrna-seq-å…¥é—¨.html"><i class="fa fa-check"></i><b>6</b> (PART) scRNA-Seq å…¥é—¨</a></li>
<li class="chapter" data-level="7" data-path="å•æ ·æœ¬åˆ†æ.html"><a href="å•æ ·æœ¬åˆ†æ.html"><i class="fa fa-check"></i><b>7</b> å•æ ·æœ¬åˆ†æ</a>
<ul>
<li class="chapter" data-level="7.1" data-path="å•æ ·æœ¬åˆ†æ.html"><a href="å•æ ·æœ¬åˆ†æ.html#è®¾ç½®seuratå¯¹è±¡"><i class="fa fa-check"></i><b>7.1</b> è®¾ç½®Seuratå¯¹è±¡</a></li>
<li class="chapter" data-level="7.2" data-path="å•æ ·æœ¬åˆ†æ.html"><a href="å•æ ·æœ¬åˆ†æ.html#è´¨é‡æ§åˆ¶"><i class="fa fa-check"></i><b>7.2</b> è´¨é‡æ§åˆ¶</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="å•æ ·æœ¬åˆ†æ.html"><a href="å•æ ·æœ¬åˆ†æ.html#è®¡ç®—æ¯ä¸ªç»†èƒçº¿ç²’ä½“åŸºå› çš„ç™¾åˆ†æ¯”"><i class="fa fa-check"></i><b>7.2.1</b> è®¡ç®—æ¯ä¸ªç»†èƒçº¿ç²’ä½“åŸºå› çš„ç™¾åˆ†æ¯”</a></li>
<li class="chapter" data-level="7.2.2" data-path="å•æ ·æœ¬åˆ†æ.html"><a href="å•æ ·æœ¬åˆ†æ.html#è¿‡æ»¤"><i class="fa fa-check"></i><b>7.2.2</b> è¿‡æ»¤</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="å•æ ·æœ¬åˆ†æ.html"><a href="å•æ ·æœ¬åˆ†æ.html#æ•°æ®æ ‡å‡†åŒ–-1"><i class="fa fa-check"></i><b>7.3</b> æ•°æ®æ ‡å‡†åŒ–</a></li>
<li class="chapter" data-level="7.4" data-path="å•æ ·æœ¬åˆ†æ.html"><a href="å•æ ·æœ¬åˆ†æ.html#è¯†åˆ«é«˜å˜åŸºå› -1"><i class="fa fa-check"></i><b>7.4</b> è¯†åˆ«é«˜å˜åŸºå› </a></li>
<li class="chapter" data-level="7.5" data-path="å•æ ·æœ¬åˆ†æ.html"><a href="å•æ ·æœ¬åˆ†æ.html#ç¼©æ”¾æ•°æ®-1"><i class="fa fa-check"></i><b>7.5</b> ç¼©æ”¾æ•°æ®</a></li>
<li class="chapter" data-level="7.6" data-path="å•æ ·æœ¬åˆ†æ.html"><a href="å•æ ·æœ¬åˆ†æ.html#pca-çº¿æ€§é™ç»´"><i class="fa fa-check"></i><b>7.6</b> PCA çº¿æ€§é™ç»´</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="å•æ ·æœ¬åˆ†æ.html"><a href="å•æ ·æœ¬åˆ†æ.html#ç¡®å®šæ•°æ®é›†çš„ç»´åº¦"><i class="fa fa-check"></i><b>7.6.1</b> ç¡®å®šæ•°æ®é›†çš„â€œç»´åº¦â€</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="å•æ ·æœ¬åˆ†æ.html"><a href="å•æ ·æœ¬åˆ†æ.html#ç»†èƒèšç±»-1"><i class="fa fa-check"></i><b>7.7</b> ç»†èƒèšç±»</a></li>
<li class="chapter" data-level="7.8" data-path="å•æ ·æœ¬åˆ†æ.html"><a href="å•æ ·æœ¬åˆ†æ.html#éçº¿æ€§é™ç»´umaptsne-1"><i class="fa fa-check"></i><b>7.8</b> éçº¿æ€§é™ç»´UMAP/tSNE</a></li>
<li class="chapter" data-level="7.9" data-path="å•æ ·æœ¬åˆ†æ.html"><a href="å•æ ·æœ¬åˆ†æ.html#marker-åŸºå› -1"><i class="fa fa-check"></i><b>7.9</b> marker åŸºå› </a></li>
<li class="chapter" data-level="7.10" data-path="å•æ ·æœ¬åˆ†æ.html"><a href="å•æ ·æœ¬åˆ†æ.html#äºšç¾¤å‘½å"><i class="fa fa-check"></i><b>7.10</b> äºšç¾¤å‘½å</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="å¤šæ ·æœ¬åˆ†æ.html"><a href="å¤šæ ·æœ¬åˆ†æ.html"><i class="fa fa-check"></i><b>8</b> å¤šæ ·æœ¬åˆ†æ</a>
<ul>
<li class="chapter" data-level="8.1" data-path="å¤šæ ·æœ¬åˆ†æ.html"><a href="å¤šæ ·æœ¬åˆ†æ.html#åŠ è½½åŒ…"><i class="fa fa-check"></i><b>8.1</b> åŠ è½½åŒ…</a></li>
<li class="chapter" data-level="8.2" data-path="å¤šæ ·æœ¬åˆ†æ.html"><a href="å¤šæ ·æœ¬åˆ†æ.html#åˆ›å»ºå¤šæ ·æœ¬seuratå¯¹è±¡"><i class="fa fa-check"></i><b>8.2</b> åˆ›å»ºå¤šæ ·æœ¬Seuratå¯¹è±¡</a></li>
<li class="chapter" data-level="8.3" data-path="å¤šæ ·æœ¬åˆ†æ.html"><a href="å¤šæ ·æœ¬åˆ†æ.html#è´¨æ§"><i class="fa fa-check"></i><b>8.3</b> è´¨æ§</a></li>
<li class="chapter" data-level="8.4" data-path="å¤šæ ·æœ¬åˆ†æ.html"><a href="å¤šæ ·æœ¬åˆ†æ.html#harmonyæµç¨‹"><i class="fa fa-check"></i><b>8.4</b> harmonyæµç¨‹</a></li>
<li class="chapter" data-level="8.5" data-path="å¤šæ ·æœ¬åˆ†æ.html"><a href="å¤šæ ·æœ¬åˆ†æ.html#marker-åŸºå› -2"><i class="fa fa-check"></i><b>8.5</b> marker åŸºå› </a></li>
<li class="chapter" data-level="8.6" data-path="å¤šæ ·æœ¬åˆ†æ.html"><a href="å¤šæ ·æœ¬åˆ†æ.html#äºšç¾¤å‘½å-1"><i class="fa fa-check"></i><b>8.6</b> äºšç¾¤å‘½å</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="part-å¤šæ ·æœ¬åˆ†æ-pipline.html"><a href="part-å¤šæ ·æœ¬åˆ†æ-pipline.html"><i class="fa fa-check"></i><b>9</b> (PART) å¤šæ ·æœ¬åˆ†æ pipline</a></li>
<li class="chapter" data-level="10" data-path="åŸºç¡€æµç¨‹.html"><a href="åŸºç¡€æµç¨‹.html"><i class="fa fa-check"></i><b>10</b> åŸºç¡€æµç¨‹</a>
<ul>
<li class="chapter" data-level="10.1" data-path="åŸºç¡€æµç¨‹.html"><a href="åŸºç¡€æµç¨‹.html#åŠ è½½åŒ…-1"><i class="fa fa-check"></i><b>10.1</b> åŠ è½½åŒ…</a></li>
<li class="chapter" data-level="10.2" data-path="åŸºç¡€æµç¨‹.html"><a href="åŸºç¡€æµç¨‹.html#åˆ›å»ºå¤šæ ·æœ¬seuratå¯¹è±¡-1"><i class="fa fa-check"></i><b>10.2</b> åˆ›å»ºå¤šæ ·æœ¬Seuratå¯¹è±¡</a></li>
<li class="chapter" data-level="10.3" data-path="åŸºç¡€æµç¨‹.html"><a href="åŸºç¡€æµç¨‹.html#è´¨æ§-1"><i class="fa fa-check"></i><b>10.3</b> è´¨æ§</a></li>
<li class="chapter" data-level="10.4" data-path="åŸºç¡€æµç¨‹.html"><a href="åŸºç¡€æµç¨‹.html#harmonyæµç¨‹-1"><i class="fa fa-check"></i><b>10.4</b> harmonyæµç¨‹</a></li>
<li class="chapter" data-level="10.5" data-path="åŸºç¡€æµç¨‹.html"><a href="åŸºç¡€æµç¨‹.html#marker-åŸºå› -3"><i class="fa fa-check"></i><b>10.5</b> marker åŸºå› </a></li>
<li class="chapter" data-level="10.6" data-path="åŸºç¡€æµç¨‹.html"><a href="åŸºç¡€æµç¨‹.html#äºšç¾¤å‘½å-2"><i class="fa fa-check"></i><b>10.6</b> äºšç¾¤å‘½å</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ç»†èƒäºšç¾¤å“åº”æ³¨é‡Š.html"><a href="ç»†èƒäºšç¾¤å“åº”æ³¨é‡Š.html"><i class="fa fa-check"></i><b>11</b> ç»†èƒäºšç¾¤å“åº”æ³¨é‡Š</a>
<ul>
<li class="chapter" data-level="11.1" data-path="ç»†èƒäºšç¾¤å“åº”æ³¨é‡Š.html"><a href="ç»†èƒäºšç¾¤å“åº”æ³¨é‡Š.html#åŠ è½½åŒ…-2"><i class="fa fa-check"></i><b>11.1</b> åŠ è½½åŒ…</a></li>
<li class="chapter" data-level="11.2" data-path="ç»†èƒäºšç¾¤å“åº”æ³¨é‡Š.html"><a href="ç»†èƒäºšç¾¤å“åº”æ³¨é‡Š.html#æå–å„ä¸ªäºšç¾¤çš„markeråŸºå› "><i class="fa fa-check"></i><b>11.2</b> æå–å„ä¸ªäºšç¾¤çš„markeråŸºå› </a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://space.bilibili.com/338686099" target="blank">æœ¬ç¬”è®°æ¥è‡ª ç”Ÿä¿¡æŠ€èƒ½ä¹¦</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">scRNA-Seq åˆ†æç¬”è®°</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="å•æ ·æœ¬åˆ†æ" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">ç¬¬ 7 ç« </span> å•æ ·æœ¬åˆ†æ<a href="å•æ ·æœ¬åˆ†æ.html#å•æ ·æœ¬åˆ†æ" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>æœ¬ç« èŠ‚æ•°æ®å’Œä»£ç æ¥è‡ªSeuratå®˜ç½‘æ•°æ®ï¼Œæ˜¯10X Genomics å…è´¹æä¾›çš„å¤–å‘¨è¡€å•æ ¸ç»†èƒ (PBMC) æ•°æ®ã€‚
æ•°æ®å¯<a href="https://cf.10xgenomics.com/samples/cell/pbmc3k/pbmc3k_filtered_gene_bc_matrices.tar.gz">åœ¨æ­¤</a>ä¸‹è½½ã€‚</p>
<p>åŸºæœ¬æµç¨‹å¦‚ä¸‹ï¼š
<img src="images/single-01.png" width="884" style="display: block; margin: auto;" /></p>
<div id="è®¾ç½®seuratå¯¹è±¡" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> è®¾ç½®Seuratå¯¹è±¡<a href="å•æ ·æœ¬åˆ†æ.html#è®¾ç½®seuratå¯¹è±¡" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>é¦–å…ˆè¯»å–æ•°æ®ã€‚<code>Read10X()</code> å‡½æ•°è¯»å–æ¥è‡ª 10X çš„ cellranger pipline çš„è¾“å‡ºï¼Œè¿”å›ä¸€ä¸ªå”¯ä¸€åˆ†å­æ ‡è¯†ï¼ˆUMIï¼‰è®¡æ•°çŸ©é˜µã€‚è¯¥çŸ©é˜µä¸­çš„å€¼è¡¨ç¤ºåœ¨æ¯ä¸ªå•å…ƒï¼ˆå³ç»†èƒï¼›åˆ—ï¼‰ä¸­æ£€æµ‹åˆ°çš„æ¯ä¸ªç‰¹å¾ï¼ˆå³åŸºå› ï¼›è¡Œï¼‰çš„åˆ†å­æ•°é‡ã€‚ç„¶åæˆ‘ä»¬ä½¿ç”¨è®¡æ•°çŸ©é˜µæ¥åˆ›å»ºSeuratå¯¹è±¡ã€‚è¯¥å¯¹è±¡å……å½“ä¸€ä¸ªå®¹å™¨ï¼Œå…¶ä¸­åŒ…å«å•ç»†èƒæ•°æ®é›†çš„æ•°æ®ï¼ˆå¦‚è®¡æ•°çŸ©é˜µï¼‰å’Œåˆ†æï¼ˆå¦‚ PCA æˆ–èšç±»ç»“æœï¼‰ã€‚</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb5-1" tabindex="-1"></a><span class="co"># åŠ è½½åŒ…</span></span>
<span id="cb5-2"><a href="å•æ ·æœ¬åˆ†æ.html#cb5-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb5-3"><a href="å•æ ·æœ¬åˆ†æ.html#cb5-3" tabindex="-1"></a><span class="fu">library</span>(Seurat)</span>
<span id="cb5-4"><a href="å•æ ·æœ¬åˆ†æ.html#cb5-4" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb5-5"><a href="å•æ ·æœ¬åˆ†æ.html#cb5-5" tabindex="-1"></a></span>
<span id="cb5-6"><a href="å•æ ·æœ¬åˆ†æ.html#cb5-6" tabindex="-1"></a><span class="co"># è¯»å–æ•°æ®</span></span>
<span id="cb5-7"><a href="å•æ ·æœ¬åˆ†æ.html#cb5-7" tabindex="-1"></a>pbmc.data <span class="ot">&lt;-</span> <span class="fu">Read10X</span>(<span class="at">data.dir =</span> <span class="st">&quot;data/single_sample/filtered_gene_bc_matrices/hg19/&quot;</span>)</span>
<span id="cb5-8"><a href="å•æ ·æœ¬åˆ†æ.html#cb5-8" tabindex="-1"></a></span>
<span id="cb5-9"><a href="å•æ ·æœ¬åˆ†æ.html#cb5-9" tabindex="-1"></a><span class="co"># åˆ›å»ºSeuratå¯¹è±¡</span></span>
<span id="cb5-10"><a href="å•æ ·æœ¬åˆ†æ.html#cb5-10" tabindex="-1"></a>pbmc <span class="ot">&lt;-</span> <span class="fu">CreateSeuratObject</span>(<span class="at">counts =</span> pbmc.data,</span>
<span id="cb5-11"><a href="å•æ ·æœ¬åˆ†æ.html#cb5-11" tabindex="-1"></a>                           <span class="at">project =</span> <span class="st">&quot;pbmc3k&quot;</span>, <span class="co">#è‡ªå®šä¹‰é¡¹ç›®å</span></span>
<span id="cb5-12"><a href="å•æ ·æœ¬åˆ†æ.html#cb5-12" tabindex="-1"></a>                           <span class="at">min.cells =</span> <span class="dv">3</span>,  <span class="co"># æ¯ä¸ªåŸºå› è‡³å°‘åœ¨3ä¸ªç»†èƒä¸­æ£€æµ‹åˆ°</span></span>
<span id="cb5-13"><a href="å•æ ·æœ¬åˆ†æ.html#cb5-13" tabindex="-1"></a>                           <span class="at">min.features =</span> <span class="dv">200</span>) <span class="co"># æ¯ä¸ªç»†èƒè‡³å°‘æ£€æµ‹åˆ°200ä¸ªåŸºå› </span></span>
<span id="cb5-14"><a href="å•æ ·æœ¬åˆ†æ.html#cb5-14" tabindex="-1"></a></span>
<span id="cb5-15"><a href="å•æ ·æœ¬åˆ†æ.html#cb5-15" tabindex="-1"></a>pbmc</span>
<span id="cb5-16"><a href="å•æ ·æœ¬åˆ†æ.html#cb5-16" tabindex="-1"></a><span class="do">## An object of class Seurat </span></span>
<span id="cb5-17"><a href="å•æ ·æœ¬åˆ†æ.html#cb5-17" tabindex="-1"></a><span class="do">## 13714 features across 2700 samples within 1 assay </span></span>
<span id="cb5-18"><a href="å•æ ·æœ¬åˆ†æ.html#cb5-18" tabindex="-1"></a><span class="do">## Active assay: RNA (13714 features, 0 variable features)</span></span>
<span id="cb5-19"><a href="å•æ ·æœ¬åˆ†æ.html#cb5-19" tabindex="-1"></a><span class="do">##  1 layer present: counts</span></span></code></pre></div>
</div>
<div id="è´¨é‡æ§åˆ¶" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> è´¨é‡æ§åˆ¶<a href="å•æ ·æœ¬åˆ†æ.html#è´¨é‡æ§åˆ¶" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>åœ¨åˆ›å»ºSeuratæ—¶ (<code>CreateSeuratObject</code>) å·²ç»å®Œæˆäº†åŸºæœ¬çš„è´¨é‡æ§åˆ¶ï¼Œå³æ¯ä¸ªåŸºå› è‡³å°‘åœ¨3ä¸ªç»†èƒä¸­æ£€æµ‹åˆ°ï¼Œæ¯ä¸ªç»†èƒè‡³å°‘æ£€æµ‹åˆ°200ä¸ªåŸºå› ã€‚
ä½†ä»ç„¶å¯ä»¥æ ¹æ®éœ€è¦è¿›ä¸€æ­¥è¿‡æ»¤æ•°æ®ã€‚ä¾‹å¦‚é«˜åŸºå› è®¡æ•°ã€é«˜çº¿ç²’ä½“æ¯”ä¾‹çš„ç»†èƒã€‚</p>
<div id="è®¡ç®—æ¯ä¸ªç»†èƒçº¿ç²’ä½“åŸºå› çš„ç™¾åˆ†æ¯”" class="section level3 hasAnchor" number="7.2.1">
<h3><span class="header-section-number">7.2.1</span> è®¡ç®—æ¯ä¸ªç»†èƒçº¿ç²’ä½“åŸºå› çš„ç™¾åˆ†æ¯”<a href="å•æ ·æœ¬åˆ†æ.html#è®¡ç®—æ¯ä¸ªç»†èƒçº¿ç²’ä½“åŸºå› çš„ç™¾åˆ†æ¯”" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb6-1" tabindex="-1"></a>pbmc[[<span class="st">&quot;percent.mt&quot;</span>]] <span class="ot">&lt;-</span> <span class="fu">PercentageFeatureSet</span>(pbmc, <span class="at">pattern =</span> <span class="st">&quot;^MT-&quot;</span>)</span></code></pre></div>
<details>
<summary>
QCæŒ‡æ ‡å‚¨å­˜ä½ç½®
</summary>
<p>Seuratå¯¹è±¡çš„<code>meta.data</code>ä¸­å‚¨å­˜äº†è´¨é‡æ§åˆ¶çš„æŒ‡æ ‡ï¼Œä»–æ˜¯ä¸€ä¸ªæ•°æ®æ¡†ï¼Œæ¯ä¸€è¡Œä»£è¡¨ä¸€ä¸ªç»†èƒï¼Œæ¯ä¸€åˆ—ä»£è¡¨ä¸€ä¸ªæŒ‡æ ‡ã€‚</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb7-1" tabindex="-1"></a><span class="co"># æŸ¥çœ‹å‰5è¡Œ</span></span>
<span id="cb7-2"><a href="å•æ ·æœ¬åˆ†æ.html#cb7-2" tabindex="-1"></a><span class="fu">head</span>(pbmc<span class="sc">@</span>meta.data, <span class="dv">5</span>)</span>
<span id="cb7-3"><a href="å•æ ·æœ¬åˆ†æ.html#cb7-3" tabindex="-1"></a><span class="do">##                  orig.ident nCount_RNA nFeature_RNA percent.mt</span></span>
<span id="cb7-4"><a href="å•æ ·æœ¬åˆ†æ.html#cb7-4" tabindex="-1"></a><span class="do">## AAACATACAACCAC-1     pbmc3k       2419          779  3.0177759</span></span>
<span id="cb7-5"><a href="å•æ ·æœ¬åˆ†æ.html#cb7-5" tabindex="-1"></a><span class="do">## AAACATTGAGCTAC-1     pbmc3k       4903         1352  3.7935958</span></span>
<span id="cb7-6"><a href="å•æ ·æœ¬åˆ†æ.html#cb7-6" tabindex="-1"></a><span class="do">## AAACATTGATCAGC-1     pbmc3k       3147         1129  0.8897363</span></span>
<span id="cb7-7"><a href="å•æ ·æœ¬åˆ†æ.html#cb7-7" tabindex="-1"></a><span class="do">## AAACCGTGCTTCCG-1     pbmc3k       2639          960  1.7430845</span></span>
<span id="cb7-8"><a href="å•æ ·æœ¬åˆ†æ.html#cb7-8" tabindex="-1"></a><span class="do">## AAACCGTGTATGCG-1     pbmc3k        980          521  1.2244898</span></span>
<span id="cb7-9"><a href="å•æ ·æœ¬åˆ†æ.html#cb7-9" tabindex="-1"></a></span>
<span id="cb7-10"><a href="å•æ ·æœ¬åˆ†æ.html#cb7-10" tabindex="-1"></a><span class="co"># View(pbmc@meta.data) #æˆ–è€…ç›´æ¥æŸ¥çœ‹</span></span></code></pre></div>
<p>å…¶ä¸­ï¼Œå‰ä¸‰åˆ—æŒ‡æ ‡æ˜¯æˆ‘ä»¬åœ¨åˆ›å»ºSeuratå¯¹è±¡æ—¶å€™è®¾å®šçš„ã€‚
ç¬¬ä¸€åˆ—<code>orig.ident</code>æ˜¯åŸå§‹ç»†èƒçš„æ ‡è¯†ï¼›
ç¬¬äºŒåˆ—<code>nCount_RNA</code>æ˜¯æ¯ä¸ªç»†èƒçš„RNAåˆ†å­æ•°ï¼›
ç¬¬ä¸‰åˆ—<code>nFeature_RNA</code>æ˜¯æ¯ä¸ªç»†èƒæ£€æµ‹åˆ°çš„åŸºå› æ•°ã€‚</p>
</details>
<details>
<summary>
QCå¯è§†åŒ–
</summary>
<p>é€šå¸¸æˆ‘ä»¬å¯¹æ¯ä¸ªç»†èƒè¿›è¡Œç»Ÿè®¡åˆ†æåï¼Œä¼šå¾—åˆ°ä¸€äº›è´¨é‡æ§åˆ¶æŒ‡æ ‡ï¼Œå¦‚ç»†èƒçš„RNAåˆ†å­æ•°ã€æ£€æµ‹åˆ°çš„åŸºå› æ•°ã€çº¿ç²’ä½“åŸºå› çš„ç™¾åˆ†æ¯”ç­‰ã€‚æˆ‘ä»¬å¯¹è¿™äº›æŒ‡æ ‡è¿›è¡Œå¯è§†åŒ–ï¼Œä»¥ä¾¿æ›´å¥½åœ°äº†è§£æ•°æ®çš„è´¨é‡ã€‚è¿™ä¹Ÿä¸ºæˆ‘ä»¬å¦‚ä½•é€‰æ‹©åˆé€‚çš„è¿‡æ»¤é˜ˆå€¼è¿›è¡Œä¸‹ä¸€æ­¥åˆ†ææä¾›äº†å‚è€ƒã€‚</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb8-1" tabindex="-1"></a><span class="co"># å°æç´å›¾å¯è§†åŒ–QCæŒ‡æ ‡</span></span>
<span id="cb8-2"><a href="å•æ ·æœ¬åˆ†æ.html#cb8-2" tabindex="-1"></a><span class="fu">VlnPlot</span>(pbmc, <span class="at">features =</span> <span class="fu">c</span>(<span class="st">&quot;nFeature_RNA&quot;</span>, <span class="st">&quot;nCount_RNA&quot;</span>, <span class="st">&quot;percent.mt&quot;</span>), <span class="at">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="03-single_files/figure-html/unnamed-chunk-5-1.png" width="1152" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb9-1" tabindex="-1"></a><span class="co"># æ•£ç‚¹å›¾å¯è§†åŒ–QCæŒ‡æ ‡</span></span>
<span id="cb9-2"><a href="å•æ ·æœ¬åˆ†æ.html#cb9-2" tabindex="-1"></a><span class="fu">FeatureScatter</span>(pbmc, <span class="at">feature1 =</span> <span class="st">&quot;nCount_RNA&quot;</span>, <span class="at">feature2 =</span> <span class="st">&quot;nFeature_RNA&quot;</span>) <span class="sc">|</span></span>
<span id="cb9-3"><a href="å•æ ·æœ¬åˆ†æ.html#cb9-3" tabindex="-1"></a><span class="fu">FeatureScatter</span>(pbmc, <span class="at">feature1 =</span> <span class="st">&quot;nCount_RNA&quot;</span>, <span class="at">feature2 =</span> <span class="st">&quot;nFeature_RNA&quot;</span>)</span></code></pre></div>
<p><img src="03-single_files/figure-html/unnamed-chunk-6-1.png" width="1152" style="display: block; margin: auto;" /></p>
<details>
</div>
<div id="è¿‡æ»¤" class="section level3 hasAnchor" number="7.2.2">
<h3><span class="header-section-number">7.2.2</span> è¿‡æ»¤<a href="å•æ ·æœ¬åˆ†æ.html#è¿‡æ»¤" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>æ ¹æ®æˆ‘ä»¬çš„è¿‡æ»¤æ ‡å‡†ï¼Œæˆ‘ä»¬å¯ä»¥è¿‡æ»¤æ‰ä¸€äº›è´¨é‡è¾ƒå·®çš„ç»†èƒã€‚</p>
<p>è¿™é‡Œæˆ‘ä»¬è¿‡æ»¤æ‰</p>
<ul>
<li>RNAåˆ†å­æ•°å¤§äº2500å’Œå°äº200çš„ç»†èƒã€‚</li>
<li>çº¿ç²’ä½“æ¯”ä¾‹å¤§äº5%çš„ç»†èƒã€‚</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb10-1" tabindex="-1"></a>pbmc <span class="ot">&lt;-</span> <span class="fu">subset</span>(pbmc, <span class="at">subset =</span> nFeature_RNA <span class="sc">&gt;</span> <span class="dv">200</span> <span class="sc">&amp;</span> nFeature_RNA <span class="sc">&lt;</span> <span class="dv">2500</span> <span class="sc">&amp;</span> percent.mt <span class="sc">&lt;</span> <span class="dv">5</span>)</span>
<span id="cb10-2"><a href="å•æ ·æœ¬åˆ†æ.html#cb10-2" tabindex="-1"></a><span class="fu">dim</span>(pbmc)</span>
<span id="cb10-3"><a href="å•æ ·æœ¬åˆ†æ.html#cb10-3" tabindex="-1"></a><span class="do">## [1] 13714  2638</span></span></code></pre></div>
<p>å¯ä»¥çœ‹åˆ°è¿‡æ»¤åæˆ‘ä»¬çš„ç»†èƒæ•°ä»<code>2700</code>é™åˆ°<code>2638</code>ã€‚</p>
</div>
</div>
<div id="æ•°æ®æ ‡å‡†åŒ–-1" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> æ•°æ®æ ‡å‡†åŒ–<a href="å•æ ·æœ¬åˆ†æ.html#æ•°æ®æ ‡å‡†åŒ–-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb11-1" tabindex="-1"></a>pbmc <span class="ot">&lt;-</span> <span class="fu">NormalizeData</span>(pbmc, <span class="at">normalization.method =</span> <span class="st">&quot;LogNormalize&quot;</span>, <span class="at">scale.factor =</span> <span class="dv">10000</span>)</span></code></pre></div>
<details>
<summary>
æ ‡å‡†åŒ–å€¼å‚¨å­˜ä½ç½®
</summary>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb12-1" tabindex="-1"></a><span class="fu">head</span>(pbmc[[<span class="st">&quot;RNA&quot;</span>]]<span class="sc">$</span>data, <span class="dv">5</span>)[,<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>] <span class="co"># åŒæ ·æ˜¯ä¸€ä¸ªç¨€ç–çŸ©é˜µ</span></span>
<span id="cb12-2"><a href="å•æ ·æœ¬åˆ†æ.html#cb12-2" tabindex="-1"></a><span class="do">## 5 x 3 sparse Matrix of class &quot;dgCMatrix&quot;</span></span>
<span id="cb12-3"><a href="å•æ ·æœ¬åˆ†æ.html#cb12-3" tabindex="-1"></a><span class="do">##               AAACATACAACCAC-1 AAACATTGAGCTAC-1 AAACATTGATCAGC-1</span></span>
<span id="cb12-4"><a href="å•æ ·æœ¬åˆ†æ.html#cb12-4" tabindex="-1"></a><span class="do">## AL627309.1                   .                .                .</span></span>
<span id="cb12-5"><a href="å•æ ·æœ¬åˆ†æ.html#cb12-5" tabindex="-1"></a><span class="do">## AP006222.2                   .                .                .</span></span>
<span id="cb12-6"><a href="å•æ ·æœ¬åˆ†æ.html#cb12-6" tabindex="-1"></a><span class="do">## RP11-206L10.2                .                .                .</span></span>
<span id="cb12-7"><a href="å•æ ·æœ¬åˆ†æ.html#cb12-7" tabindex="-1"></a><span class="do">## RP11-206L10.9                .                .                .</span></span>
<span id="cb12-8"><a href="å•æ ·æœ¬åˆ†æ.html#cb12-8" tabindex="-1"></a><span class="do">## LINC00115                    .                .                .</span></span></code></pre></div>
</details>
<details>
<summary>
æ•°æ®æ ‡å‡†åŒ–å‰ååŒºåˆ«
</summary>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb13-1" tabindex="-1"></a>k_c<span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(pbmc[[<span class="st">&quot;RNA&quot;</span>]]<span class="sc">$</span>counts) <span class="co"># åŸå§‹è®¡æ•°çŸ©é˜µ</span></span>
<span id="cb13-2"><a href="å•æ ·æœ¬åˆ†æ.html#cb13-2" tabindex="-1"></a>k_n<span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(pbmc[[<span class="st">&quot;RNA&quot;</span>]]<span class="sc">$</span>data) <span class="co"># æ ‡å‡†åŒ–åçš„è®¡æ•°çŸ©é˜µ</span></span>
<span id="cb13-3"><a href="å•æ ·æœ¬åˆ†æ.html#cb13-3" tabindex="-1"></a>k1<span class="ot">&lt;-</span> <span class="fu">apply</span>(k_c, <span class="dv">2</span>, sum)  <span class="co"># åŸå§‹æ¯ä¸ªç»†èƒåŸºå› è¡¨è¾¾çš„æ€»è®¡æ•°</span></span>
<span id="cb13-4"><a href="å•æ ·æœ¬åˆ†æ.html#cb13-4" tabindex="-1"></a>k2<span class="ot">&lt;-</span> <span class="fu">apply</span>(k_n, <span class="dv">2</span>, sum) <span class="co"># æ ‡å‡†åŒ–åæ¯ä¸ªç»†èƒåŸºå› è¡¨è¾¾çš„æ€»è®¡æ•°</span></span>
<span id="cb13-5"><a href="å•æ ·æœ¬åˆ†æ.html#cb13-5" tabindex="-1"></a><span class="fu">hist</span>(k1, <span class="at">main=</span><span class="st">&quot;Histogram of raw data&quot;</span>)</span>
<span id="cb13-6"><a href="å•æ ·æœ¬åˆ†æ.html#cb13-6" tabindex="-1"></a><span class="fu">hist</span>(k2, <span class="at">main=</span><span class="st">&quot;hisogram of normalized data&quot;</span>)</span></code></pre></div>
<img src="03-single_files/figure-html/unnamed-chunk-10-1.png" width="50%" style="display: block; margin: auto;" /><img src="03-single_files/figure-html/unnamed-chunk-10-2.png" width="50%" style="display: block; margin: auto;" />
</details>
</div>
<div id="è¯†åˆ«é«˜å˜åŸºå› -1" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> è¯†åˆ«é«˜å˜åŸºå› <a href="å•æ ·æœ¬åˆ†æ.html#è¯†åˆ«é«˜å˜åŸºå› -1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>è¯†åˆ«é«˜å˜åŸºå› é€šè¿‡<code>FindVariableFeatures</code>å‡½æ•°å®ç°ã€‚è¯¥å‡½æ•°è®¡ç®—æ¯ä¸ªåŸºå› çš„æ–¹å·®ï¼Œå¹¶æ ¹æ®æ–¹å·®çš„å¤§å°å¯¹åŸºå› è¿›è¡Œæ’åºã€‚æˆ‘ä»¬å¯ä»¥é€‰æ‹©ä¸€å®šæ•°é‡çš„é«˜å˜åŸºå› ç”¨äºä¸‹æ¸¸åˆ†æã€‚
é»˜è®¤æƒ…å†µä¸‹ï¼Œæ¯ä¸ªæ•°æ®é›†ä¼šè¿”å›<code>2000</code>ä¸ªé«˜å˜åŸºå› ã€‚</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb14-1" tabindex="-1"></a>pbmc <span class="ot">&lt;-</span> <span class="fu">FindVariableFeatures</span>(pbmc, <span class="at">selection.method =</span> <span class="st">&quot;vst&quot;</span>, <span class="at">nfeatures =</span> <span class="dv">2000</span>)</span>
<span id="cb14-2"><a href="å•æ ·æœ¬åˆ†æ.html#cb14-2" tabindex="-1"></a></span>
<span id="cb14-3"><a href="å•æ ·æœ¬åˆ†æ.html#cb14-3" tabindex="-1"></a><span class="co"># Identify the 10 most highly variable genes</span></span>
<span id="cb14-4"><a href="å•æ ·æœ¬åˆ†æ.html#cb14-4" tabindex="-1"></a>top10 <span class="ot">&lt;-</span> <span class="fu">head</span>(<span class="fu">VariableFeatures</span>(pbmc), <span class="dv">10</span>)</span>
<span id="cb14-5"><a href="å•æ ·æœ¬åˆ†æ.html#cb14-5" tabindex="-1"></a></span>
<span id="cb14-6"><a href="å•æ ·æœ¬åˆ†æ.html#cb14-6" tabindex="-1"></a><span class="co"># plot variable features with and without labels</span></span>
<span id="cb14-7"><a href="å•æ ·æœ¬åˆ†æ.html#cb14-7" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">VariableFeaturePlot</span>(pbmc)</span>
<span id="cb14-8"><a href="å•æ ·æœ¬åˆ†æ.html#cb14-8" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">LabelPoints</span>(<span class="at">plot =</span> plot1, <span class="at">points =</span> top10, <span class="at">repel =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-9"><a href="å•æ ·æœ¬åˆ†æ.html#cb14-9" tabindex="-1"></a>plot1 <span class="sc">+</span> plot2</span></code></pre></div>
<p><img src="03-single_files/figure-html/unnamed-chunk-11-1.png" width="1152" style="display: block; margin: auto;" /></p>
<details>
<summary>
é«˜å˜åŸºå› ä¿¡æ¯å‚¨å­˜ä½ç½®
</summary>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb15-1" tabindex="-1"></a>pbmc[[<span class="st">&quot;RNA&quot;</span>]]<span class="sc">@</span>meta.data<span class="sc">$</span>var.features <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="å•æ ·æœ¬åˆ†æ.html#cb15-2" tabindex="-1"></a>  <span class="fu">is.na</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="å•æ ·æœ¬åˆ†æ.html#cb15-3" tabindex="-1"></a>  <span class="st">`</span><span class="at">!</span><span class="st">`</span>  <span class="sc">%&gt;%</span> </span>
<span id="cb15-4"><a href="å•æ ·æœ¬åˆ†æ.html#cb15-4" tabindex="-1"></a>  <span class="fu">sum</span>()</span>
<span id="cb15-5"><a href="å•æ ·æœ¬åˆ†æ.html#cb15-5" tabindex="-1"></a><span class="do">## [1] 2000</span></span></code></pre></div>
å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„æ•°æ®é›†ä¸­è¯†åˆ«åˆ°çš„<code>2000</code>ä¸ªé«˜å˜åŸºå› ã€‚
</details>
</div>
<div id="ç¼©æ”¾æ•°æ®-1" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> ç¼©æ”¾æ•°æ®<a href="å•æ ·æœ¬åˆ†æ.html#ç¼©æ”¾æ•°æ®-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>åº”ç”¨çº¿æ€§å˜æ¢ï¼ˆâ€œscalingâ€ï¼‰ç¼©æ”¾æ•°æ®ï¼Œè¿™æ˜¯PCAç­‰é™ç»´æŠ€æœ¯ä¹‹å‰çš„æ ‡å‡†é¢„å¤„ç†æ­¥éª¤ï¼Œä½¿ç”¨<code>ScaleData</code>å‡½æ•°å®Œæˆè¿™ä¸€æ­¥ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œä»…ç¼©æ”¾å¯å˜åŸºå› ï¼Œä½†ä¹Ÿå¯ä»¥é€‰æ‹©ç¼©æ”¾æ‰€æœ‰åŸºå› ã€‚</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb16-1" tabindex="-1"></a>all.genes <span class="ot">&lt;-</span> <span class="fu">rownames</span>(pbmc)</span>
<span id="cb16-2"><a href="å•æ ·æœ¬åˆ†æ.html#cb16-2" tabindex="-1"></a>pbmc <span class="ot">&lt;-</span> <span class="fu">ScaleData</span>(pbmc, <span class="at">features =</span> all.genes)</span></code></pre></div>
<details>
<summary>
ç¼©æ”¾åæ•°æ®å‚¨å­˜ä½ç½®
</summary>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb17-1" tabindex="-1"></a>pbmc[[<span class="st">&quot;RNA&quot;</span>]]<span class="sc">$</span>scale.data[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>]</span>
<span id="cb17-2"><a href="å•æ ·æœ¬åˆ†æ.html#cb17-2" tabindex="-1"></a><span class="do">##               AAACATACAACCAC-1 AAACATTGAGCTAC-1 AAACATTGATCAGC-1</span></span>
<span id="cb17-3"><a href="å•æ ·æœ¬åˆ†æ.html#cb17-3" tabindex="-1"></a><span class="do">## AL627309.1         -0.05812316      -0.05812316      -0.05812316</span></span>
<span id="cb17-4"><a href="å•æ ·æœ¬åˆ†æ.html#cb17-4" tabindex="-1"></a><span class="do">## AP006222.2         -0.03357571      -0.03357571      -0.03357571</span></span>
<span id="cb17-5"><a href="å•æ ·æœ¬åˆ†æ.html#cb17-5" tabindex="-1"></a><span class="do">## RP11-206L10.2      -0.04166819      -0.04166819      -0.04166819</span></span>
<span id="cb17-6"><a href="å•æ ·æœ¬åˆ†æ.html#cb17-6" tabindex="-1"></a><span class="do">## RP11-206L10.9      -0.03364562      -0.03364562      -0.03364562</span></span>
<span id="cb17-7"><a href="å•æ ·æœ¬åˆ†æ.html#cb17-7" tabindex="-1"></a><span class="do">## LINC00115          -0.08223981      -0.08223981      -0.08223981</span></span></code></pre></div>
</details>
<details>
<summary>
å¦‚ä½•æ¶ˆé™¤ä¸éœ€è¦çš„å˜å¼‚æº
</summary>
<p>åœ¨ Seurat ä¸­ï¼Œ<code>ScaleData()</code>å‡½æ•°ä¸ä»…ç”¨äºå¯¹æ•°æ®è¿›è¡Œç¼©æ”¾ï¼ˆæ ‡å‡†åŒ–ï¼‰ï¼Œè¿˜å¯ä»¥ç”¨äºå›å½’æ‰æ•°æ®ä¸­çš„ä¸éœ€è¦çš„å˜å¼‚æ¥æºã€‚è¿™äº›ä¸éœ€è¦çš„å˜å¼‚æ¥æºå¯èƒ½åŒ…æ‹¬<a href="https://satijalab.org/seurat/articles/cell_cycle_vignette">ç»†èƒå‘¨æœŸé˜¶æ®µ</a>ã€çº¿ç²’ä½“æ±¡æŸ“ç­‰ã€‚é€šè¿‡å›å½’æ‰è¿™äº›å˜å¼‚æ¥æºï¼Œå¯ä»¥å‡å°‘å®ƒä»¬å¯¹ä¸‹æ¸¸åˆ†æï¼ˆå¦‚èšç±»ã€é™ç»´ç­‰ï¼‰çš„å½±å“ï¼Œä»è€Œæ›´å¥½åœ°æ­ç¤ºç”Ÿç‰©å­¦ä¸Šæœ‰æ„ä¹‰çš„ä¿¡å·ã€‚</p>
<p>â€œå›å½’æ‰â€å˜å¼‚æ¥æºæ˜¯æŒ‡é€šè¿‡çº¿æ€§å›å½’æ¨¡å‹ï¼Œå°†è¿™äº›ä¸éœ€è¦çš„å˜å¼‚ä»åŸºå› è¡¨è¾¾æ•°æ®ä¸­ç§»é™¤ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯å‡å°‘è¿™äº›å˜å¼‚å¯¹æ•°æ®çš„å½±å“ï¼Œä½¿å¾—ä¸‹æ¸¸åˆ†ææ›´åŠ å‡†ç¡®å’Œå¯é ã€‚</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb18-1" tabindex="-1"></a>pbmc <span class="ot">&lt;-</span> <span class="fu">ScaleData</span>(pbmc, <span class="at">vars.to.regress =</span> <span class="st">&quot;percent.mt&quot;</span>)</span></code></pre></div>
ä½†æ˜¯å¯¹äºæƒ³ä½¿ç”¨æ­¤åŠŸèƒ½çš„ï¼ŒSeuratä½œè€…å®˜ç½‘ä¸­å¼ºçƒˆå»ºè®®åœ¨æ•°æ®æ ‡å‡†åŒ–æ­¥éª¤èµ°<a href="https://satijalab.org/seurat/reference/sctransform">SCTransform()</a>æµç¨‹ï¼Œè€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨<code>ScaleData</code>å‡½æ•°ã€‚
</details>
</div>
<div id="pca-çº¿æ€§é™ç»´" class="section level2 hasAnchor" number="7.6">
<h2><span class="header-section-number">7.6</span> PCA çº¿æ€§é™ç»´<a href="å•æ ·æœ¬åˆ†æ.html#pca-çº¿æ€§é™ç»´" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>PCA æ˜¯ä¸€ç§å¸¸ç”¨çš„é™ç»´æŠ€æœ¯ï¼Œç”¨äºå°†é«˜ç»´æ•°æ®è½¬æ¢ä¸ºä½ç»´æ•°æ®ã€‚åœ¨å•ç»†èƒæ•°æ®ä¸­ï¼ŒPCAé€šå¸¸ç”¨äºå‘ç°æ•°æ®ä¸­çš„ä¸»è¦å˜åŒ–æ–¹å‘ï¼Œä»¥ä¾¿åœ¨åç»­åˆ†æä¸­ä½¿ç”¨ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œä»…å°†å…ˆå‰è¯†åˆ«çš„é«˜å˜åŸºå› ç”¨äº PCA è¾“å…¥ã€‚PCA å¸®åŠ©è¯†åˆ«æ•°æ®ä¸­å˜åŒ–æœ€å¤§çš„æ–¹å‘ï¼Œå¹¶å°†è¿™äº›æ–¹å‘ä½œä¸ºæ–°çš„åæ ‡è½´ï¼ˆä¸»æˆåˆ†ï¼‰ï¼Œå‡å°‘æ•°æ®çš„ç»´åº¦ã€‚</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb19-1" tabindex="-1"></a>pbmc <span class="ot">&lt;-</span> <span class="fu">RunPCA</span>(pbmc, <span class="at">features =</span> <span class="fu">VariableFeatures</span>(<span class="at">object =</span> pbmc))</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb20-1" tabindex="-1"></a><span class="co"># Examine and visualize PCA results a few different ways</span></span>
<span id="cb20-2"><a href="å•æ ·æœ¬åˆ†æ.html#cb20-2" tabindex="-1"></a><span class="fu">print</span>(pbmc[[<span class="st">&quot;pca&quot;</span>]], <span class="at">dims =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">nfeatures =</span> <span class="dv">5</span>)</span>
<span id="cb20-3"><a href="å•æ ·æœ¬åˆ†æ.html#cb20-3" tabindex="-1"></a><span class="do">## PC_ 1 </span></span>
<span id="cb20-4"><a href="å•æ ·æœ¬åˆ†æ.html#cb20-4" tabindex="-1"></a><span class="do">## Positive:  CST3, TYROBP, LST1, AIF1, FTL </span></span>
<span id="cb20-5"><a href="å•æ ·æœ¬åˆ†æ.html#cb20-5" tabindex="-1"></a><span class="do">## Negative:  MALAT1, LTB, IL32, IL7R, CD2 </span></span>
<span id="cb20-6"><a href="å•æ ·æœ¬åˆ†æ.html#cb20-6" tabindex="-1"></a><span class="do">## PC_ 2 </span></span>
<span id="cb20-7"><a href="å•æ ·æœ¬åˆ†æ.html#cb20-7" tabindex="-1"></a><span class="do">## Positive:  CD79A, MS4A1, TCL1A, HLA-DQA1, HLA-DQB1 </span></span>
<span id="cb20-8"><a href="å•æ ·æœ¬åˆ†æ.html#cb20-8" tabindex="-1"></a><span class="do">## Negative:  NKG7, PRF1, CST7, GZMB, GZMA </span></span>
<span id="cb20-9"><a href="å•æ ·æœ¬åˆ†æ.html#cb20-9" tabindex="-1"></a><span class="do">## PC_ 3 </span></span>
<span id="cb20-10"><a href="å•æ ·æœ¬åˆ†æ.html#cb20-10" tabindex="-1"></a><span class="do">## Positive:  HLA-DQA1, CD79A, CD79B, HLA-DQB1, HLA-DPB1 </span></span>
<span id="cb20-11"><a href="å•æ ·æœ¬åˆ†æ.html#cb20-11" tabindex="-1"></a><span class="do">## Negative:  PPBP, PF4, SDPR, SPARC, GNG11 </span></span>
<span id="cb20-12"><a href="å•æ ·æœ¬åˆ†æ.html#cb20-12" tabindex="-1"></a><span class="do">## PC_ 4 </span></span>
<span id="cb20-13"><a href="å•æ ·æœ¬åˆ†æ.html#cb20-13" tabindex="-1"></a><span class="do">## Positive:  HLA-DQA1, CD79B, CD79A, MS4A1, HLA-DQB1 </span></span>
<span id="cb20-14"><a href="å•æ ·æœ¬åˆ†æ.html#cb20-14" tabindex="-1"></a><span class="do">## Negative:  VIM, IL7R, S100A6, IL32, S100A8 </span></span>
<span id="cb20-15"><a href="å•æ ·æœ¬åˆ†æ.html#cb20-15" tabindex="-1"></a><span class="do">## PC_ 5 </span></span>
<span id="cb20-16"><a href="å•æ ·æœ¬åˆ†æ.html#cb20-16" tabindex="-1"></a><span class="do">## Positive:  GZMB, NKG7, S100A8, FGFBP2, GNLY </span></span>
<span id="cb20-17"><a href="å•æ ·æœ¬åˆ†æ.html#cb20-17" tabindex="-1"></a><span class="do">## Negative:  LTB, IL7R, CKB, VIM, MS4A7</span></span></code></pre></div>
<details>
<summary>
ğŸŒŸå¯è§†åŒ–PCAç»“æœ
</summary>
<p><code>VizDimLoadings</code> å‡½æ•°å¯è§†åŒ–å‰ä¸¤ä¸ªä¸»æˆåˆ†ï¼ˆPC1å’ŒPC2ï¼‰ä¸ŠåŸºå› çš„åŠ è½½å€¼ã€‚åŠ è½½å€¼ä»£è¡¨æ¯ä¸ªåŸºå› åœ¨ä¸»æˆåˆ†ä¸Šçš„è´¡çŒ®å¤§å°ï¼Œå¸®åŠ©è¯†åˆ«å“ªäº›åŸºå› åœ¨ç‰¹å®šä¸»æˆåˆ†ä¸Šæœ‰è¾ƒå¤§çš„å½±å“ã€‚</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb21-1" tabindex="-1"></a><span class="fu">VizDimLoadings</span>(pbmc, <span class="at">dims =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">reduction =</span> <span class="st">&quot;pca&quot;</span>)</span></code></pre></div>
<p><img src="03-single_files/figure-html/unnamed-chunk-18-1.png" width="1152" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb22-1" tabindex="-1"></a><span class="fu">DimPlot</span>(pbmc, <span class="at">reduction =</span> <span class="st">&quot;pca&quot;</span>) <span class="sc">+</span> <span class="fu">NoLegend</span>()</span></code></pre></div>
<p><img src="03-single_files/figure-html/unnamed-chunk-19-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><code>DimHeatmap()</code> å‡½æ•°ç”¨äºåœ¨ä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰åç”Ÿæˆçƒ­å›¾ï¼Œå¸®åŠ©æ¢ç´¢æ•°æ®ä¸­çš„ä¸»è¦å¼‚è´¨æ€§æ¥æºï¼Œå¹¶å†³å®šå“ªäº›ä¸»æˆåˆ†ï¼ˆPCsï¼‰åº”åŒ…æ‹¬åœ¨åç»­åˆ†æä¸­ã€‚çƒ­å›¾ä¸­çš„ç»†èƒå’Œç‰¹å¾æ ¹æ®å®ƒä»¬çš„ PCA åˆ†æ•°æ’åºï¼Œè®¾ç½® <code>cells</code> å‚æ•°ä¸ºä¸€ä¸ªæ•°å­—å¯ä»¥åŠ é€Ÿå¤§æ•°æ®é›†çš„ç»˜å›¾ã€‚å°½ç®¡è¿™æ˜¯ç›‘ç£åˆ†æï¼Œä½†å®ƒæ˜¯æ¢ç´¢ç›¸å…³ç‰¹å¾é›†çš„æœ‰ä»·å€¼å·¥å…·ã€‚</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb23-1" tabindex="-1"></a><span class="fu">DimHeatmap</span>(pbmc, <span class="at">dims =</span> <span class="dv">1</span>, <span class="at">cells =</span> <span class="dv">500</span>, <span class="at">balanced =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="03-single_files/figure-html/unnamed-chunk-20-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb24-1" tabindex="-1"></a><span class="fu">DimHeatmap</span>(pbmc, <span class="at">dims =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span>, <span class="at">cells =</span> <span class="dv">500</span>, <span class="at">balanced =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<img src="03-single_files/figure-html/unnamed-chunk-21-1.png" width="672" style="display: block; margin: auto;" />
</details>
<div id="ç¡®å®šæ•°æ®é›†çš„ç»´åº¦" class="section level3 hasAnchor" number="7.6.1">
<h3><span class="header-section-number">7.6.1</span> ç¡®å®šæ•°æ®é›†çš„â€œç»´åº¦â€<a href="å•æ ·æœ¬åˆ†æ.html#ç¡®å®šæ•°æ®é›†çš„ç»´åº¦" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>å•ä¸ªç‰¹å¾çš„æŠ€æœ¯å™ªå£°åœ¨ scRNA-seq æ•°æ®ä¸­é€šå¸¸å¾ˆå¤§ã€‚ä¸ºäº†å…‹æœè¿™ä¸€é—®é¢˜ï¼ŒSeurat æ ¹æ®ç»†èƒçš„ PCA åˆ†æ•°è¿›è¡Œèšç±»ï¼Œæ¯ä¸ªä¸»æˆåˆ†ï¼ˆPCï¼‰å®é™…ä¸Šä»£è¡¨ä¸€ä¸ªâ€œå…ƒç‰¹å¾â€ï¼Œå®ƒç»“åˆäº†å¤šä¸ªç›¸å…³ç‰¹å¾çš„ä¿¡æ¯ã€‚å› æ­¤ï¼Œå‰å‡ ä¸ªä¸»æˆåˆ†ä»£è¡¨äº†æ•°æ®é›†çš„ä¸€ä¸ªç¨³å¥å‹ç¼©ã€‚ä½†æ˜¯é¢ä¸´çš„ä¸€ä¸ªé‡è¦é—®é¢˜æ˜¯åº”è¯¥é€‰æ‹©å¤šå°‘ä¸ªä¸»æˆåˆ†æ¥åŒ…æ‹¬åœ¨åˆ†æä¸­ï¼Œæ¯”å¦‚ 10 ä¸ªã€20 ä¸ªè¿˜æ˜¯ 100 ä¸ªï¼Ÿ</p>
<p>Seurat ä½œè€…æ¨èå¯ä»¥ç”Ÿæˆä¸€ä¸ªâ€œè‚˜éƒ¨å›¾â€ï¼ˆElbow plotï¼‰ï¼Œè¿™æ˜¯ä¸€ä¸ªåŸºäºæ¯ä¸ªä¸»æˆåˆ†æ‰€è§£é‡Šçš„æ–¹å·®ç™¾åˆ†æ¯”çš„æ’åã€‚å›¾ä¸­é€šå¸¸ä¼šå‡ºç°ä¸€ä¸ªâ€è‚˜éƒ¨â€ï¼Œå³æ ‡å‡†å·®å¼€å§‹æ˜¾è‘—ä¸‹é™çš„ç‚¹ï¼Œé€‰æ‹©è¿™ä¸ªç‚¹ä¹‹å‰çš„ä¸»æˆåˆ†æ•°ç›®é€šå¸¸æ˜¯åˆé€‚çš„ã€‚å¹¶ä¸”å»ºè®®åœ¨é€‰æ‹©è¯¥å‚æ•°æ—¶å®å¯åé«˜ã€‚</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb25-1" tabindex="-1"></a><span class="fu">ElbowPlot</span>(pbmc)</span></code></pre></div>
<p><img src="03-single_files/figure-html/unnamed-chunk-22-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå¯ä»¥è§‚å¯Ÿåˆ°å¤§çº¦åœ¨ç¬¬ 9-10 ä¸ªä¸»æˆåˆ†å¤„å‡ºç°ä¸€ä¸ªâ€œè‚˜éƒ¨â€ï¼Œè¿™è¡¨æ˜å‰ 10 ä¸ªä¸»æˆåˆ†æ•æ‰åˆ°äº†å¤§éƒ¨åˆ†çš„çœŸå®ä¿¡å·ã€‚</p>
</div>
</div>
<div id="ç»†èƒèšç±»-1" class="section level2 hasAnchor" number="7.7">
<h2><span class="header-section-number">7.7</span> ç»†èƒèšç±»<a href="å•æ ·æœ¬åˆ†æ.html#ç»†èƒèšç±»-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>FindNeighbors()</code>å‡½æ•°å°†å…ˆå‰å®šä¹‰çš„æ•°æ®é›†ç»´åº¦ï¼ˆå‰ 10 ä¸ª PCï¼‰ä½œä¸ºè¾“å…¥ã€‚</p>
<p><code>FindClusters()</code>å‡½æ•°åŒ…å«ä¸€ä¸ªåˆ†è¾¨ç‡å‚æ•°ï¼Œç”¨äºè®¾ç½®ä¸‹æ¸¸èšç±»çš„â€œç²’åº¦â€ï¼Œå¢åŠ çš„å€¼ä¼šå¯¼è‡´æ›´å¤šçš„èšç±»ã€‚æ­¤å‚æ•°è®¾ç½®åœ¨ 0.4-1.2 ä¹‹é—´é€šå¸¸ä¼šä¸ºå¤§çº¦ 3K ç»†èƒçš„å•ç»†èƒæ•°æ®é›†å¸¦æ¥è‰¯å¥½çš„ç»“æœã€‚å¯¹äºè¾ƒå¤§çš„æ•°æ®é›†ï¼Œæœ€ä½³åˆ†è¾¨ç‡é€šå¸¸ä¼šå¢åŠ </p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb26-1" tabindex="-1"></a>pbmc <span class="ot">&lt;-</span> <span class="fu">FindNeighbors</span>(pbmc, <span class="at">dims =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb26-2"><a href="å•æ ·æœ¬åˆ†æ.html#cb26-2" tabindex="-1"></a>pbmc <span class="ot">&lt;-</span> <span class="fu">FindClusters</span>(pbmc, <span class="at">resolution =</span> <span class="fl">0.5</span>)</span>
<span id="cb26-3"><a href="å•æ ·æœ¬åˆ†æ.html#cb26-3" tabindex="-1"></a><span class="do">## Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck</span></span>
<span id="cb26-4"><a href="å•æ ·æœ¬åˆ†æ.html#cb26-4" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb26-5"><a href="å•æ ·æœ¬åˆ†æ.html#cb26-5" tabindex="-1"></a><span class="do">## Number of nodes: 2638</span></span>
<span id="cb26-6"><a href="å•æ ·æœ¬åˆ†æ.html#cb26-6" tabindex="-1"></a><span class="do">## Number of edges: 95927</span></span>
<span id="cb26-7"><a href="å•æ ·æœ¬åˆ†æ.html#cb26-7" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb26-8"><a href="å•æ ·æœ¬åˆ†æ.html#cb26-8" tabindex="-1"></a><span class="do">## Running Louvain algorithm...</span></span>
<span id="cb26-9"><a href="å•æ ·æœ¬åˆ†æ.html#cb26-9" tabindex="-1"></a><span class="do">## Maximum modularity in 10 random starts: 0.8728</span></span>
<span id="cb26-10"><a href="å•æ ·æœ¬åˆ†æ.html#cb26-10" tabindex="-1"></a><span class="do">## Number of communities: 9</span></span>
<span id="cb26-11"><a href="å•æ ·æœ¬åˆ†æ.html#cb26-11" tabindex="-1"></a><span class="do">## Elapsed time: 0 seconds</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb27-1" tabindex="-1"></a><span class="co"># Look at cluster IDs of the first 5 cells</span></span>
<span id="cb27-2"><a href="å•æ ·æœ¬åˆ†æ.html#cb27-2" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">Idents</span>(pbmc), <span class="dv">5</span>)</span>
<span id="cb27-3"><a href="å•æ ·æœ¬åˆ†æ.html#cb27-3" tabindex="-1"></a><span class="do">## AAACATACAACCAC-1 AAACATTGAGCTAC-1 AAACATTGATCAGC-1 AAACCGTGCTTCCG-1 </span></span>
<span id="cb27-4"><a href="å•æ ·æœ¬åˆ†æ.html#cb27-4" tabindex="-1"></a><span class="do">##                2                3                2                1 </span></span>
<span id="cb27-5"><a href="å•æ ·æœ¬åˆ†æ.html#cb27-5" tabindex="-1"></a><span class="do">## AAACCGTGTATGCG-1 </span></span>
<span id="cb27-6"><a href="å•æ ·æœ¬åˆ†æ.html#cb27-6" tabindex="-1"></a><span class="do">##                6 </span></span>
<span id="cb27-7"><a href="å•æ ·æœ¬åˆ†æ.html#cb27-7" tabindex="-1"></a><span class="do">## Levels: 0 1 2 3 4 5 6 7 8</span></span></code></pre></div>
</div>
<div id="éçº¿æ€§é™ç»´umaptsne-1" class="section level2 hasAnchor" number="7.8">
<h2><span class="header-section-number">7.8</span> éçº¿æ€§é™ç»´UMAP/tSNE<a href="å•æ ·æœ¬åˆ†æ.html#éçº¿æ€§é™ç»´umaptsne-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Seurat æä¾›äº†å‡ ç§éçº¿æ€§é™ç»´æŠ€æœ¯ï¼Œä¾‹å¦‚ tSNE å’Œ UMAPï¼Œç”¨äºå¯è§†åŒ–å’Œæ¢ç´¢è¿™äº›æ•°æ®é›†ã€‚è¿™äº›ç®—æ³•çš„ç›®æ ‡æ˜¯å­¦ä¹ æ•°æ®é›†ä¸­çš„åº•å±‚ç»“æ„ï¼Œä»¥ä¾¿åœ¨ä½ç»´ç©ºé—´ä¸­å°†ç›¸ä¼¼çš„ç»†èƒæ”¾åœ¨ä¸€èµ·ã€‚å› æ­¤ï¼Œåœ¨ä¸Šè¿°åŸºäºå›¾çš„èšç±»ä¸­è¢«åˆ†ç»„åœ¨ä¸€èµ·çš„ç»†èƒåº”è¯¥åœ¨è¿™äº›é™ç»´å›¾ä¸Šå…±å®šä½ã€‚</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb28-1" tabindex="-1"></a>pbmc <span class="ot">&lt;-</span> <span class="fu">RunUMAP</span>(pbmc, <span class="at">dims =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb29-1" tabindex="-1"></a>pbmc <span class="ot">&lt;-</span> <span class="fu">RunTSNE</span>(pbmc, <span class="at">dims =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb30-1" tabindex="-1"></a><span class="co"># note that you can set `label = TRUE` or use the LabelClusters function to help label</span></span>
<span id="cb30-2"><a href="å•æ ·æœ¬åˆ†æ.html#cb30-2" tabindex="-1"></a><span class="co"># individual clusters</span></span>
<span id="cb30-3"><a href="å•æ ·æœ¬åˆ†æ.html#cb30-3" tabindex="-1"></a><span class="fu">DimPlot</span>(pbmc, <span class="at">reduction =</span> <span class="st">&quot;umap&quot;</span>)<span class="sc">|</span></span>
<span id="cb30-4"><a href="å•æ ·æœ¬åˆ†æ.html#cb30-4" tabindex="-1"></a><span class="fu">DimPlot</span>(pbmc, <span class="at">reduction =</span> <span class="st">&quot;tsne&quot;</span>)</span></code></pre></div>
<p><img src="03-single_files/figure-html/unnamed-chunk-27-1.png" width="1152" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb31-1" tabindex="-1"></a><span class="fu">saveRDS</span>(pbmc, <span class="at">file =</span> <span class="st">&quot;../output/pbmc_tutorial.rds&quot;</span>)</span></code></pre></div>
</div>
<div id="marker-åŸºå› -1" class="section level2 hasAnchor" number="7.9">
<h2><span class="header-section-number">7.9</span> marker åŸºå› <a href="å•æ ·æœ¬åˆ†æ.html#marker-åŸºå› -1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Seurat å¯ä»¥é€šè¿‡å·®å¼‚è¡¨è¾¾ï¼ˆDEï¼‰å¸®åŠ©ä½ æ‰¾åˆ°å®šä¹‰èšç±»çš„æ ‡å¿—ç‰©ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå®ƒä¼šè¯†åˆ«ä¸€ä¸ªèšç±»ï¼ˆåœ¨ ident.1ä¸­æŒ‡å®šï¼‰çš„æ­£è´Ÿæ ‡å¿—ç‰©ï¼Œå¹¶å°†å…¶ä¸æ‰€æœ‰å…¶ä»–ç»†èƒè¿›è¡Œæ¯”è¾ƒã€‚FindAllMarkers() å‡½æ•°å¯ä»¥è‡ªåŠ¨å®Œæˆæ‰€æœ‰èšç±»çš„è¿™ä¸ªè¿‡ç¨‹ï¼Œä½†ä½ ä¹Ÿå¯ä»¥æµ‹è¯•èšç±»ç»„ä¹‹é—´çš„å·®å¼‚ï¼Œæˆ–è€…å°†å…¶ä¸æ‰€æœ‰ç»†èƒè¿›è¡Œæ¯”è¾ƒã€‚</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb32-1" tabindex="-1"></a><span class="co"># find all markers of cluster 2</span></span>
<span id="cb32-2"><a href="å•æ ·æœ¬åˆ†æ.html#cb32-2" tabindex="-1"></a>cluster2.markers <span class="ot">&lt;-</span> <span class="fu">FindMarkers</span>(pbmc, <span class="at">ident.1 =</span> <span class="dv">2</span>)</span>
<span id="cb32-3"><a href="å•æ ·æœ¬åˆ†æ.html#cb32-3" tabindex="-1"></a><span class="fu">head</span>(cluster2.markers, <span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb32-4"><a href="å•æ ·æœ¬åˆ†æ.html#cb32-4" tabindex="-1"></a><span class="do">##             p_val avg_log2FC pct.1 pct.2    p_val_adj</span></span>
<span id="cb32-5"><a href="å•æ ·æœ¬åˆ†æ.html#cb32-5" tabindex="-1"></a><span class="do">## IL32 2.892340e-90  1.3070772 0.947 0.465 3.966555e-86</span></span>
<span id="cb32-6"><a href="å•æ ·æœ¬åˆ†æ.html#cb32-6" tabindex="-1"></a><span class="do">## LTB  1.060121e-86  1.3312674 0.981 0.643 1.453850e-82</span></span>
<span id="cb32-7"><a href="å•æ ·æœ¬åˆ†æ.html#cb32-7" tabindex="-1"></a><span class="do">## CD3D 8.794641e-71  1.0597620 0.922 0.432 1.206097e-66</span></span>
<span id="cb32-8"><a href="å•æ ·æœ¬åˆ†æ.html#cb32-8" tabindex="-1"></a><span class="do">## IL7R 3.516098e-68  1.4377848 0.750 0.326 4.821977e-64</span></span>
<span id="cb32-9"><a href="å•æ ·æœ¬åˆ†æ.html#cb32-9" tabindex="-1"></a><span class="do">## LDHB 1.642480e-67  0.9911924 0.954 0.614 2.252497e-63</span></span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb33-1" tabindex="-1"></a><span class="co"># find all markers distinguishing cluster 5 from clusters 0 and 3</span></span>
<span id="cb33-2"><a href="å•æ ·æœ¬åˆ†æ.html#cb33-2" tabindex="-1"></a>cluster5.markers <span class="ot">&lt;-</span> <span class="fu">FindMarkers</span>(pbmc, <span class="at">ident.1 =</span> <span class="dv">5</span>, <span class="at">ident.2 =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>))</span>
<span id="cb33-3"><a href="å•æ ·æœ¬åˆ†æ.html#cb33-3" tabindex="-1"></a><span class="fu">head</span>(cluster5.markers, <span class="at">n =</span> <span class="dv">5</span>)</span>
<span id="cb33-4"><a href="å•æ ·æœ¬åˆ†æ.html#cb33-4" tabindex="-1"></a><span class="do">##                       p_val avg_log2FC pct.1 pct.2     p_val_adj</span></span>
<span id="cb33-5"><a href="å•æ ·æœ¬åˆ†æ.html#cb33-5" tabindex="-1"></a><span class="do">## FCGR3A        8.246578e-205   6.794969 0.975 0.040 1.130936e-200</span></span>
<span id="cb33-6"><a href="å•æ ·æœ¬åˆ†æ.html#cb33-6" tabindex="-1"></a><span class="do">## IFITM3        1.677613e-195   6.192558 0.975 0.049 2.300678e-191</span></span>
<span id="cb33-7"><a href="å•æ ·æœ¬åˆ†æ.html#cb33-7" tabindex="-1"></a><span class="do">## CFD           2.401156e-193   6.015172 0.938 0.038 3.292945e-189</span></span>
<span id="cb33-8"><a href="å•æ ·æœ¬åˆ†æ.html#cb33-8" tabindex="-1"></a><span class="do">## CD68          2.900384e-191   5.530330 0.926 0.035 3.977587e-187</span></span>
<span id="cb33-9"><a href="å•æ ·æœ¬åˆ†æ.html#cb33-9" tabindex="-1"></a><span class="do">## RP11-290F20.3 2.513244e-186   6.297999 0.840 0.017 3.446663e-182</span></span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb34-1" tabindex="-1"></a><span class="co"># find markers for every cluster compared to all remaining cells, report only the positive</span></span>
<span id="cb34-2"><a href="å•æ ·æœ¬åˆ†æ.html#cb34-2" tabindex="-1"></a><span class="co"># ones</span></span>
<span id="cb34-3"><a href="å•æ ·æœ¬åˆ†æ.html#cb34-3" tabindex="-1"></a>pbmc.markers <span class="ot">&lt;-</span> <span class="fu">FindAllMarkers</span>(pbmc, <span class="at">only.pos =</span> <span class="cn">TRUE</span>)</span>
<span id="cb34-4"><a href="å•æ ·æœ¬åˆ†æ.html#cb34-4" tabindex="-1"></a>pbmc.markers <span class="sc">%&gt;%</span></span>
<span id="cb34-5"><a href="å•æ ·æœ¬åˆ†æ.html#cb34-5" tabindex="-1"></a>    <span class="fu">group_by</span>(cluster) <span class="sc">%&gt;%</span></span>
<span id="cb34-6"><a href="å•æ ·æœ¬åˆ†æ.html#cb34-6" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(avg_log2FC <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb34-7"><a href="å•æ ·æœ¬åˆ†æ.html#cb34-7" tabindex="-1"></a><span class="do">## # A tibble: 7,019 Ã— 7</span></span>
<span id="cb34-8"><a href="å•æ ·æœ¬åˆ†æ.html#cb34-8" tabindex="-1"></a><span class="do">## # Groups:   cluster [9]</span></span>
<span id="cb34-9"><a href="å•æ ·æœ¬åˆ†æ.html#cb34-9" tabindex="-1"></a><span class="do">##        p_val avg_log2FC pct.1 pct.2 p_val_adj cluster gene     </span></span>
<span id="cb34-10"><a href="å•æ ·æœ¬åˆ†æ.html#cb34-10" tabindex="-1"></a><span class="do">##        &lt;dbl&gt;      &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;fct&gt;   &lt;chr&gt;    </span></span>
<span id="cb34-11"><a href="å•æ ·æœ¬åˆ†æ.html#cb34-11" tabindex="-1"></a><span class="do">##  1 3.75e-112       1.21 0.912 0.592 5.14e-108 0       LDHB     </span></span>
<span id="cb34-12"><a href="å•æ ·æœ¬åˆ†æ.html#cb34-12" tabindex="-1"></a><span class="do">##  2 9.57e- 88       2.40 0.447 0.108 1.31e- 83 0       CCR7     </span></span>
<span id="cb34-13"><a href="å•æ ·æœ¬åˆ†æ.html#cb34-13" tabindex="-1"></a><span class="do">##  3 1.15e- 76       1.06 0.845 0.406 1.58e- 72 0       CD3D     </span></span>
<span id="cb34-14"><a href="å•æ ·æœ¬åˆ†æ.html#cb34-14" tabindex="-1"></a><span class="do">##  4 1.12e- 54       1.04 0.731 0.4   1.54e- 50 0       CD3E     </span></span>
<span id="cb34-15"><a href="å•æ ·æœ¬åˆ†æ.html#cb34-15" tabindex="-1"></a><span class="do">##  5 1.35e- 51       2.14 0.342 0.103 1.86e- 47 0       LEF1     </span></span>
<span id="cb34-16"><a href="å•æ ·æœ¬åˆ†æ.html#cb34-16" tabindex="-1"></a><span class="do">##  6 1.94e- 47       1.20 0.629 0.359 2.66e- 43 0       NOSIP    </span></span>
<span id="cb34-17"><a href="å•æ ·æœ¬åˆ†æ.html#cb34-17" tabindex="-1"></a><span class="do">##  7 2.81e- 44       1.53 0.443 0.185 3.85e- 40 0       PIK3IP1  </span></span>
<span id="cb34-18"><a href="å•æ ·æœ¬åˆ†æ.html#cb34-18" tabindex="-1"></a><span class="do">##  8 6.27e- 43       1.99 0.33  0.112 8.60e- 39 0       PRKCQ-AS1</span></span>
<span id="cb34-19"><a href="å•æ ·æœ¬åˆ†æ.html#cb34-19" tabindex="-1"></a><span class="do">##  9 1.16e- 40       2.70 0.2   0.04  1.59e- 36 0       FHIT     </span></span>
<span id="cb34-20"><a href="å•æ ·æœ¬åˆ†æ.html#cb34-20" tabindex="-1"></a><span class="do">## 10 1.34e- 34       1.96 0.268 0.087 1.84e- 30 0       MAL      </span></span>
<span id="cb34-21"><a href="å•æ ·æœ¬åˆ†æ.html#cb34-21" tabindex="-1"></a><span class="do">## # â„¹ 7,009 more rows</span></span></code></pre></div>
<p>Seurat æœ‰å‡ ç§ç”¨äºå·®å¼‚è¡¨è¾¾åˆ†æçš„æµ‹è¯•æ–¹æ³•ï¼Œå¯ä»¥é€šè¿‡ test.use å‚æ•°è¿›è¡Œè®¾ç½®ã€‚ä¾‹å¦‚ï¼ŒROCæµ‹è¯•ä¼šè¿”å›ä»»ä½•å•ä¸ªæ ‡å¿—ç‰©çš„â€œåˆ†ç±»èƒ½åŠ›â€ï¼ˆèŒƒå›´ä»0è¡¨ç¤ºéšæœºï¼Œåˆ°1è¡¨ç¤ºå®Œç¾ï¼‰ã€‚</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb35-1" tabindex="-1"></a>cluster0.markers <span class="ot">&lt;-</span> <span class="fu">FindMarkers</span>(pbmc, <span class="at">ident.1 =</span> <span class="dv">0</span>, <span class="at">logfc.threshold =</span> <span class="fl">0.25</span>, <span class="at">test.use =</span> <span class="st">&quot;roc&quot;</span>, <span class="at">only.pos =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<details>
<summary>
ğŸŒŸå¯è§†åŒ–markeråŸºå› 
</summary>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb36-1" tabindex="-1"></a><span class="fu">VlnPlot</span>(pbmc, <span class="at">features =</span> <span class="fu">c</span>(<span class="st">&quot;MS4A1&quot;</span>, <span class="st">&quot;CD79A&quot;</span>))</span></code></pre></div>
<p><img src="03-single_files/figure-html/unnamed-chunk-33-1.png" width="1152" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb37-1" tabindex="-1"></a><span class="co"># you can plot raw counts as well</span></span>
<span id="cb37-2"><a href="å•æ ·æœ¬åˆ†æ.html#cb37-2" tabindex="-1"></a><span class="fu">VlnPlot</span>(pbmc, <span class="at">features =</span> <span class="fu">c</span>(<span class="st">&quot;NKG7&quot;</span>, <span class="st">&quot;PF4&quot;</span>), <span class="at">slot =</span> <span class="st">&quot;counts&quot;</span>, <span class="at">log =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="03-single_files/figure-html/unnamed-chunk-34-1.png" width="1152" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb38-1" tabindex="-1"></a><span class="fu">FeaturePlot</span>(pbmc, <span class="at">features =</span> <span class="fu">c</span>(<span class="st">&quot;MS4A1&quot;</span>, <span class="st">&quot;GNLY&quot;</span>, <span class="st">&quot;CD3E&quot;</span>, <span class="st">&quot;CD14&quot;</span>, <span class="st">&quot;FCER1A&quot;</span>, <span class="st">&quot;FCGR3A&quot;</span>, <span class="st">&quot;LYZ&quot;</span>, <span class="st">&quot;PPBP&quot;</span>, <span class="st">&quot;CD8A&quot;</span>))</span></code></pre></div>
<p><img src="03-single_files/figure-html/unnamed-chunk-35-1.png" width="1152" style="display: block; margin: auto;" /></p>
<p>DoHeatmap() å‡½æ•°ä¸ºç»™å®šçš„ç»†èƒå’Œç‰¹å¾ç”Ÿæˆä¸€ä¸ªè¡¨è¾¾çƒ­å›¾ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ç»˜åˆ¶äº†æ¯ä¸ªç°‡çš„å‰10ä¸ªæ ‡å¿—ç‰©ï¼ˆå¦‚æœæ ‡å¿—ç‰©å°‘äº20ä¸ªï¼Œåˆ™ç»˜åˆ¶æ‰€æœ‰æ ‡å¿—ç‰©ï¼‰ã€‚</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb39-1" tabindex="-1"></a>pbmc.markers <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="å•æ ·æœ¬åˆ†æ.html#cb39-2" tabindex="-1"></a>    <span class="fu">group_by</span>(cluster) <span class="sc">%&gt;%</span> <span class="co"># æŒ‰ç°‡ï¼ˆclusterï¼‰åˆ†ç»„</span></span>
<span id="cb39-3"><a href="å•æ ·æœ¬åˆ†æ.html#cb39-3" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(avg_log2FC <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="co"># ç­›é€‰å‡ºå¹³å‡å¯¹æ•°2å€å˜åŒ–ï¼ˆavg_log2FCï¼‰å¤§äº1çš„åŸºå› ã€‚</span></span>
<span id="cb39-4"><a href="å•æ ·æœ¬åˆ†æ.html#cb39-4" tabindex="-1"></a>    <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="co"># ä¿ç•™æ¯ä¸ªç°‡çš„å‰10ä¸ªåŸºå› </span></span>
<span id="cb39-5"><a href="å•æ ·æœ¬åˆ†æ.html#cb39-5" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="ot">-&gt;</span> top10 <span class="co"># è§£é™¤åˆ†ç»„ï¼Œå¹¶å°†ç»“æœå­˜å‚¨åˆ°`top10`å˜é‡ä¸­</span></span>
<span id="cb39-6"><a href="å•æ ·æœ¬åˆ†æ.html#cb39-6" tabindex="-1"></a><span class="fu">DoHeatmap</span>(pbmc, <span class="at">features =</span> top10<span class="sc">$</span>gene) <span class="sc">+</span> <span class="fu">NoLegend</span>() </span></code></pre></div>
<p><img src="03-single_files/figure-html/unnamed-chunk-36-1.png" width="1152" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb40-1" tabindex="-1"></a>pbmc.markers <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="å•æ ·æœ¬åˆ†æ.html#cb40-2" tabindex="-1"></a>    <span class="fu">group_by</span>(cluster) <span class="sc">%&gt;%</span> <span class="co"># æŒ‰ç°‡ï¼ˆclusterï¼‰åˆ†ç»„</span></span>
<span id="cb40-3"><a href="å•æ ·æœ¬åˆ†æ.html#cb40-3" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">filter</span>(avg_log2FC <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">%&gt;%</span> <span class="co"># ç­›é€‰å‡ºå¹³å‡å¯¹æ•°2å€å˜åŒ–ï¼ˆavg_log2FCï¼‰å¤§äº1çš„åŸºå› ã€‚</span></span>
<span id="cb40-4"><a href="å•æ ·æœ¬åˆ†æ.html#cb40-4" tabindex="-1"></a>    <span class="fu">slice_head</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="co"># ä¿ç•™æ¯ä¸ªç°‡çš„å‰10ä¸ªåŸºå› </span></span>
<span id="cb40-5"><a href="å•æ ·æœ¬åˆ†æ.html#cb40-5" tabindex="-1"></a>    <span class="fu">ungroup</span>() <span class="ot">-&gt;</span> top10 <span class="co"># è§£é™¤åˆ†ç»„ï¼Œå¹¶å°†ç»“æœå­˜å‚¨åˆ°`top10`å˜é‡ä¸­</span></span>
<span id="cb40-6"><a href="å•æ ·æœ¬åˆ†æ.html#cb40-6" tabindex="-1"></a><span class="fu">RidgePlot</span>(pbmc, <span class="at">features =</span> top10<span class="sc">$</span>gene[<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>])</span></code></pre></div>
<p><img src="03-single_files/figure-html/unnamed-chunk-37-1.png" width="1152" style="display: block; margin: auto;" /></p>
</div>
<div id="äºšç¾¤å‘½å" class="section level2 hasAnchor" number="7.10">
<h2><span class="header-section-number">7.10</span> äºšç¾¤å‘½å<a href="å•æ ·æœ¬åˆ†æ.html#äºšç¾¤å‘½å" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb41-1" tabindex="-1"></a>new.cluster.ids <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Naive CD4 T&quot;</span>, <span class="st">&quot;CD14+ Mono&quot;</span>, <span class="st">&quot;Memory CD4 T&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;CD8 T&quot;</span>, <span class="st">&quot;FCGR3A+ Mono&quot;</span>,</span>
<span id="cb41-2"><a href="å•æ ·æœ¬åˆ†æ.html#cb41-2" tabindex="-1"></a>    <span class="st">&quot;NK&quot;</span>, <span class="st">&quot;DC&quot;</span>, <span class="st">&quot;Platelet&quot;</span>)</span>
<span id="cb41-3"><a href="å•æ ·æœ¬åˆ†æ.html#cb41-3" tabindex="-1"></a><span class="fu">names</span>(new.cluster.ids) <span class="ot">&lt;-</span> <span class="fu">levels</span>(pbmc)</span>
<span id="cb41-4"><a href="å•æ ·æœ¬åˆ†æ.html#cb41-4" tabindex="-1"></a>pbmc <span class="ot">&lt;-</span> <span class="fu">RenameIdents</span>(pbmc, new.cluster.ids)</span>
<span id="cb41-5"><a href="å•æ ·æœ¬åˆ†æ.html#cb41-5" tabindex="-1"></a><span class="fu">DimPlot</span>(pbmc, <span class="at">reduction =</span> <span class="st">&quot;umap&quot;</span>, <span class="at">label =</span> <span class="cn">TRUE</span>, <span class="at">pt.size =</span> <span class="fl">0.5</span>) <span class="sc">+</span> <span class="fu">NoLegend</span>()</span></code></pre></div>
<p><img src="03-single_files/figure-html/unnamed-chunk-38-1.png" width="672" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="å•æ ·æœ¬åˆ†æ.html#cb42-1" tabindex="-1"></a><span class="fu">saveRDS</span>(pbmc, <span class="at">file =</span> <span class="st">&quot;../output/pbmc3k_final.rds&quot;</span>)</span></code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="part-scrna-seq-å…¥é—¨.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="å¤šæ ·æœ¬åˆ†æ.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/smileszh/scRNA-Seq/edit/master/03-single.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "none"
}
});
});
</script>

</body>

</html>
